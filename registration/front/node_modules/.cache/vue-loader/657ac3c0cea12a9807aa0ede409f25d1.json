{"remainingRequest":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\graduateSys\\registration\\front\\src\\views\\template\\upload-pic-input.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\graduateSys\\registration\\front\\src\\views\\template\\upload-pic-input.vue","mtime":1743403543252},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1739857231742},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1739857230815},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1739857231742},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1739857212415}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgInZpZXdlcmpzL2Rpc3Qvdmlld2VyLmNzcyI7DQppbXBvcnQgVmlld2VyIGZyb20gInZpZXdlcmpzIjsNCmltcG9ydCB7DQogICAgdXBsb2FkRmlsZQ0KfSBmcm9tICJAL2FwaS9pbmRleCI7DQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogInVwbG9hZFBpY0lucHV0IiwNCiAgICBwcm9wczogew0KICAgICAgICB2YWx1ZTogU3RyaW5nLA0KICAgICAgICBzaXplOiBTdHJpbmcsDQogICAgICAgIHBsYWNlaG9sZGVyOiB7DQogICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICBkZWZhdWx0OiAi5Y+v6L6T5YWl5Zu+54mH6ZO+5o6lIg0KICAgICAgICB9LA0KICAgICAgICBkaXNhYmxlZDogew0KICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHJlYWRvbmx5OiB7DQogICAgICAgICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UNCiAgICAgICAgfSwNCiAgICAgICAgbWF4bGVuZ3RoOiBOdW1iZXIsDQogICAgICAgIGljb246IHsNCiAgICAgICAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgICAgICAgIGRlZmF1bHQ6ICJpb3MtY2xvdWQtdXBsb2FkLW91dGxpbmUiDQogICAgICAgIH0sDQogICAgICAgIG1heFNpemU6IHsNCiAgICAgICAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgICAgICAgIGRlZmF1bHQ6IDUNCiAgICAgICAgfSwNCiAgICAgICAgYWNjZXB0OiB7DQogICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICBkZWZhdWx0OiAiLmpwZywgLmpwZWcsIC5wbmcsIC5naWYiDQogICAgICAgIH0NCiAgICB9LA0KICAgIGNvbXB1dGVkOiB7DQogICAgICAgIGZvcm1hdCgpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmFjY2VwdCkgew0KICAgICAgICAgICAgICAgIGxldCBmb3JtYXQgPSBbXTsNCiAgICAgICAgICAgICAgICB0aGlzLmFjY2VwdC5zcGxpdCgiLCIpLmZvckVhY2goZSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1hdC5wdXNoKGUucmVwbGFjZSgiLiIsICIiKS5yZXBsYWNlKCIgIiwgIiIpKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gW107DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9LA0KICAgIGRhdGEoKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBhY2Nlc3NUb2tlbjoge30sDQogICAgICAgICAgICBjdXJyZW50VmFsdWU6IHRoaXMudmFsdWUsDQogICAgICAgICAgICBsb2FkaW5nOiBmYWxzZSwNCiAgICAgICAgICAgIHVwbG9hZEZpbGVVcmw6IHVwbG9hZEZpbGUNCiAgICAgICAgfTsNCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgICAgaW5pdCgpIHsNCiAgICAgICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSB7DQogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IHRoaXMuZ2V0U3RvcmUoImFjY2Vzc1Rva2VuIikNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQogICAgICAgIHZpZXdJbWFnZSgpIHsNCiAgICAgICAgICAgIGxldCBpbWFnZSA9IG5ldyBJbWFnZSgpOw0KICAgICAgICAgICAgaW1hZ2Uuc3JjID0gdGhpcy5jdXJyZW50VmFsdWU7DQogICAgICAgICAgICBsZXQgdmlld2VyID0gbmV3IFZpZXdlcihpbWFnZSwgew0KICAgICAgICAgICAgICAgIGhpZGRlbjogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICB2aWV3ZXIuZGVzdHJveSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdmlld2VyLnNob3coKTsNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlRm9ybWF0RXJyb3IoZmlsZSkgew0KICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgICAgICAgICB0aGlzLiROb3RpY2Uud2FybmluZyh7DQogICAgICAgICAgICAgICAgdGl0bGU6ICLkuI3mlK/mjIHnmoTmlofku7bmoLzlvI8iLA0KICAgICAgICAgICAgICAgIGRlc2M6ICLmiYDpgInmlofku7bigJggIiArDQogICAgICAgICAgICAgICAgICAgIGZpbGUubmFtZSArDQogICAgICAgICAgICAgICAgICAgICIg4oCZ5qC85byP5LiN5q2j56GuLCDor7fpgInmi6kgIiArIHRoaXMuYWNjZXB0ICsgIiDmoLzlvI/mlofku7YiDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlTWF4U2l6ZShmaWxlKSB7DQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMuJE5vdGljZS53YXJuaW5nKHsNCiAgICAgICAgICAgICAgICB0aXRsZTogIuaWh+S7tuWkp+Wwj+i/h+WkpyIsDQogICAgICAgICAgICAgICAgZGVzYzogIuaJgOmAieaWh+S7tuKAmCAiICsNCiAgICAgICAgICAgICAgICAgICAgZmlsZS5uYW1lICsNCiAgICAgICAgICAgICAgICAgICAgIiDigJnlpKflsI/ov4flpKcsIOS4jeW+l+i2hei/hyAiICsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhTaXplICsNCiAgICAgICAgICAgICAgICAgICAgIk0uIg0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sDQogICAgICAgIGJlZm9yZVVwbG9hZCgpIHsNCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlU3VjY2VzcyhyZXMsIGZpbGUpIHsNCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPSByZXMucmVzdWx0Ow0KICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgdGhpcy5jdXJyZW50VmFsdWUpOw0KICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoIm9uLWNoYW5nZSIsIHRoaXMuY3VycmVudFZhbHVlKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGhhbmRsZUVycm9yKGVycm9yLCBmaWxlLCBmaWxlTGlzdCkgew0KICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKGVycm9yLnRvU3RyaW5nKCkpOw0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVDaGFuZ2Uodikgew0KICAgICAgICAgICAgdGhpcy4kZW1pdCgiaW5wdXQiLCB0aGlzLmN1cnJlbnRWYWx1ZSk7DQogICAgICAgICAgICB0aGlzLiRlbWl0KCJvbi1jaGFuZ2UiLCB0aGlzLmN1cnJlbnRWYWx1ZSk7DQogICAgICAgIH0sDQogICAgICAgIHNldEN1cnJlbnRWYWx1ZSh2YWx1ZSkgew0KICAgICAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLmN1cnJlbnRWYWx1ZSkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlID0gdmFsdWU7DQogICAgICAgICAgICB0aGlzLiRlbWl0KCJvbi1jaGFuZ2UiLCB0aGlzLmN1cnJlbnRWYWx1ZSk7DQogICAgICAgIH0NCiAgICB9LA0KICAgIHdhdGNoOiB7DQogICAgICAgIHZhbHVlKHZhbCkgew0KICAgICAgICAgICAgdGhpcy5zZXRDdXJyZW50VmFsdWUodmFsKTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgbW91bnRlZCgpIHsNCiAgICAgICAgdGhpcy5pbml0KCk7DQogICAgfQ0KfTsNCg=="},{"version":3,"sources":["upload-pic-input.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"upload-pic-input.vue","sourceRoot":"src/views/template","sourcesContent":["<template>\r\n<div>\r\n    <div style=\"display:flex;\">\r\n        <Input v-model=\"currentValue\" @on-change=\"handleChange\" :placeholder=\"placeholder\" :size=\"size\" :disabled=\"disabled\" :readonly=\"readonly\" :maxlength=\"maxlength\" icon=\"md-eye\" style=\"margin-right:10px;\">\r\n        <Poptip transfer trigger=\"hover\" title=\"图片预览\" placement=\"right\" width=\"350\" style=\"width: 17px;cursor:pointer\" slot=\"append\">\r\n            <Button type=\"primary\" icon=\"md-eye\"></Button>\r\n            <div slot=\"content\">\r\n                <img v-show=\"currentValue\" :src=\"currentValue\" style=\"width: 100%;margin: 0 auto;display: block;cursor:zoom-in\" @click=\"viewImage\" />\r\n                <span v-show=\"!currentValue\">无效的图片链接</span>\r\n                <a v-show=\"currentValue\" @click=\"viewImage\" style=\"margin-top:5px;text-align:right;display:block\">查看大图</a>\r\n            </div>\r\n        </Poptip>\r\n        </Input>\r\n        <Upload :action=\"uploadFileUrl\" :headers=\"accessToken\" :on-success=\"handleSuccess\" :on-error=\"handleError\" :format=\"format\" :accept=\"accept\" :max-size=\"maxSize*1024\" :on-format-error=\"handleFormatError\" :on-exceeded-size=\"handleMaxSize\" :before-upload=\"beforeUpload\" :show-upload-list=\"false\">\r\n            <Button :loading=\"loading\" :size=\"size\" :disabled=\"disabled\" :icon=\"icon\">上传图片</Button>\r\n        </Upload>\r\n    </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport \"viewerjs/dist/viewer.css\";\r\nimport Viewer from \"viewerjs\";\r\nimport {\r\n    uploadFile\r\n} from \"@/api/index\";\r\nexport default {\r\n    name: \"uploadPicInput\",\r\n    props: {\r\n        value: String,\r\n        size: String,\r\n        placeholder: {\r\n            type: String,\r\n            default: \"可输入图片链接\"\r\n        },\r\n        disabled: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        readonly: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        maxlength: Number,\r\n        icon: {\r\n            type: String,\r\n            default: \"ios-cloud-upload-outline\"\r\n        },\r\n        maxSize: {\r\n            type: Number,\r\n            default: 5\r\n        },\r\n        accept: {\r\n            type: String,\r\n            default: \".jpg, .jpeg, .png, .gif\"\r\n        }\r\n    },\r\n    computed: {\r\n        format() {\r\n            if (this.accept) {\r\n                let format = [];\r\n                this.accept.split(\",\").forEach(e => {\r\n                    format.push(e.replace(\".\", \"\").replace(\" \", \"\"));\r\n                });\r\n                return format;\r\n            } else {\r\n                return [];\r\n            }\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            accessToken: {},\r\n            currentValue: this.value,\r\n            loading: false,\r\n            uploadFileUrl: uploadFile\r\n        };\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.accessToken = {\r\n                accessToken: this.getStore(\"accessToken\")\r\n            };\r\n        },\r\n        viewImage() {\r\n            let image = new Image();\r\n            image.src = this.currentValue;\r\n            let viewer = new Viewer(image, {\r\n                hidden: function () {\r\n                    viewer.destroy();\r\n                }\r\n            });\r\n            viewer.show();\r\n        },\r\n        handleFormatError(file) {\r\n            this.loading = false;\r\n            this.$Notice.warning({\r\n                title: \"不支持的文件格式\",\r\n                desc: \"所选文件‘ \" +\r\n                    file.name +\r\n                    \" ’格式不正确, 请选择 \" + this.accept + \" 格式文件\"\r\n            });\r\n        },\r\n        handleMaxSize(file) {\r\n            this.loading = false;\r\n            this.$Notice.warning({\r\n                title: \"文件大小过大\",\r\n                desc: \"所选文件‘ \" +\r\n                    file.name +\r\n                    \" ’大小过大, 不得超过 \" +\r\n                    this.maxSize +\r\n                    \"M.\"\r\n            });\r\n        },\r\n        beforeUpload() {\r\n            this.loading = true;\r\n            return true;\r\n        },\r\n        handleSuccess(res, file) {\r\n            this.loading = false;\r\n            if (res.success) {\r\n                this.currentValue = res.result;\r\n                this.$emit(\"input\", this.currentValue);\r\n                this.$emit(\"on-change\", this.currentValue);\r\n            } else {\r\n                this.$Message.error(res.message);\r\n            }\r\n        },\r\n        handleError(error, file, fileList) {\r\n            this.loading = false;\r\n            this.$Message.error(error.toString());\r\n        },\r\n        handleChange(v) {\r\n            this.$emit(\"input\", this.currentValue);\r\n            this.$emit(\"on-change\", this.currentValue);\r\n        },\r\n        setCurrentValue(value) {\r\n            if (value === this.currentValue) {\r\n                return;\r\n            }\r\n            this.currentValue = value;\r\n            this.$emit(\"on-change\", this.currentValue);\r\n        }\r\n    },\r\n    watch: {\r\n        value(val) {\r\n            this.setCurrentValue(val);\r\n        }\r\n    },\r\n    mounted() {\r\n        this.init();\r\n    }\r\n};\r\n</script>\r\n"]}]}