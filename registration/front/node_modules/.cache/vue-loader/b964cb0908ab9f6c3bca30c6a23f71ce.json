{"remainingRequest":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\graduateSys\\registration\\front\\src\\views\\template\\upload-file-input.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\graduateSys\\registration\\front\\src\\views\\template\\upload-file-input.vue","mtime":1743403543307},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1739857231742},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1739857230815},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1739857231742},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1739857212415}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgInZpZXdlcmpzL2Rpc3Qvdmlld2VyLmNzcyI7DQppbXBvcnQgVmlld2VyIGZyb20gInZpZXdlcmpzIjsNCmltcG9ydCB7IHVwbG9hZEZpbGUgfSBmcm9tICJAL2FwaS9pbmRleCI7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJ1cGxvYWRQaWNJbnB1dCIsDQogIHByb3BzOiB7DQogICAgdmFsdWU6IFN0cmluZywNCiAgICBzaXplOiBTdHJpbmcsDQogICAgcGxhY2Vob2xkZXI6IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIGRlZmF1bHQ6ICLlj6/ovpPlhaXmlofku7bpk77mjqUiDQogICAgfSwNCiAgICBidXR0b25UaXRsZTogew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgZGVmYXVsdDogIuS4iuS8oOaWh+S7tiINCiAgICB9LA0KICAgIGRpc2FibGVkOiB7DQogICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgZGVmYXVsdDogZmFsc2UNCiAgICB9LA0KICAgIHJlYWRvbmx5OiB7DQogICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgZGVmYXVsdDogZmFsc2UNCiAgICB9LA0KICAgIG1heGxlbmd0aDogTnVtYmVyLA0KICAgIGljb246IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIGRlZmF1bHQ6ICJpb3MtY2xvdWQtdXBsb2FkLW91dGxpbmUiDQogICAgfSwNCiAgICBtYXhTaXplOiB7DQogICAgICB0eXBlOiBOdW1iZXIsDQogICAgICBkZWZhdWx0OiAxMDANCiAgICB9LA0KICAgIGFjY2VwdDogew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgZGVmYXVsdDogIi5wZGYiDQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGZvcm1hdCgpIHsNCiAgICAgIGlmICh0aGlzLmFjY2VwdCkgew0KICAgICAgICBsZXQgZm9ybWF0ID0gW107DQogICAgICAgIHRoaXMuYWNjZXB0LnNwbGl0KCIsIikuZm9yRWFjaChlID0+IHsNCiAgICAgICAgICBmb3JtYXQucHVzaChlLnJlcGxhY2UoIi4iLCAiIikucmVwbGFjZSgiICIsICIiKSk7DQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gZm9ybWF0Ow0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIFtdOw0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgYWNjZXNzVG9rZW46IHt9LA0KICAgICAgY3VycmVudFZhbHVlOiB0aGlzLnZhbHVlLA0KICAgICAgbG9hZGluZzogZmFsc2UsDQogICAgICB1cGxvYWRGaWxlVXJsOiB1cGxvYWRGaWxlDQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGluaXQoKSB7DQogICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gew0KICAgICAgICBhY2Nlc3NUb2tlbjogdGhpcy5nZXRTdG9yZSgiYWNjZXNzVG9rZW4iKQ0KICAgICAgfTsNCiAgICB9LA0KICAgIGhhbmRsZUZvcm1hdEVycm9yKGZpbGUpIHsNCiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgdGhpcy4kTm90aWNlLndhcm5pbmcoew0KICAgICAgICB0aXRsZTogIuS4jeaUr+aMgeeahOaWh+S7tuagvOW8jyIsDQogICAgICAgIGRlc2M6DQogICAgICAgICAgIuaJgOmAieaWh+S7tuKAmCAiICsNCiAgICAgICAgICBmaWxlLm5hbWUgKw0KICAgICAgICAgICIg4oCZ5qC85byP5LiN5q2j56GuLCDor7fpgInmi6kgIit0aGlzLmFjY2VwdCsiIOagvOW8j+aWh+S7tiINCiAgICAgIH0pOw0KICAgIH0sDQogICAgaGFuZGxlTWF4U2l6ZShmaWxlKSB7DQogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgIHRoaXMuJE5vdGljZS53YXJuaW5nKHsNCiAgICAgICAgdGl0bGU6ICLmlofku7blpKflsI/ov4flpKciLA0KICAgICAgICBkZXNjOg0KICAgICAgICAgICLmiYDpgInmlofku7bigJggIiArDQogICAgICAgICAgZmlsZS5uYW1lICsNCiAgICAgICAgICAiIOKAmeWkp+Wwj+i/h+Wkpywg5LiN5b6X6LaF6L+HICIgKw0KICAgICAgICAgIHRoaXMubWF4U2l6ZSArDQogICAgICAgICAgIk0uIg0KICAgICAgfSk7DQogICAgfSwNCiAgICBiZWZvcmVVcGxvYWQoKSB7DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfSwNCiAgICBoYW5kbGVTdWNjZXNzKHJlcywgZmlsZSkgew0KICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsNCiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPSByZXMucmVzdWx0Ow0KICAgICAgICB0aGlzLiRlbWl0KCJpbnB1dCIsIHRoaXMuY3VycmVudFZhbHVlKTsNCiAgICAgICAgdGhpcy4kZW1pdCgib24tY2hhbmdlIiwgdGhpcy5jdXJyZW50VmFsdWUpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSk7DQogICAgICB9DQogICAgfSwNCiAgICBoYW5kbGVFcnJvcihlcnJvciwgZmlsZSwgZmlsZUxpc3QpIHsNCiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihlcnJvci50b1N0cmluZygpKTsNCiAgICB9LA0KICAgIGhhbmRsZUNoYW5nZSh2KSB7DQogICAgICB0aGlzLiRlbWl0KCJpbnB1dCIsIHRoaXMuY3VycmVudFZhbHVlKTsNCiAgICAgIHRoaXMuJGVtaXQoIm9uLWNoYW5nZSIsIHRoaXMuY3VycmVudFZhbHVlKTsNCiAgICB9LA0KICAgIHNldEN1cnJlbnRWYWx1ZSh2YWx1ZSkgew0KICAgICAgaWYgKHZhbHVlID09PSB0aGlzLmN1cnJlbnRWYWx1ZSkgew0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHZhbHVlOw0KICAgICAgdGhpcy4kZW1pdCgib24tY2hhbmdlIiwgdGhpcy5jdXJyZW50VmFsdWUpOw0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICB2YWx1ZSh2YWwpIHsNCiAgICAgIHRoaXMuc2V0Q3VycmVudFZhbHVlKHZhbCk7DQogICAgfQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuaW5pdCgpOw0KICB9DQp9Ow0K"},{"version":3,"sources":["upload-file-input.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"upload-file-input.vue","sourceRoot":"src/views/template","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"display:flex;\">\r\n      <Input\r\n        v-model=\"currentValue\"\r\n        @on-change=\"handleChange\"\r\n        :placeholder=\"placeholder\"\r\n        :size=\"size\"\r\n        :disabled=\"disabled\"\r\n        :readonly=\"readonly\"\r\n        :maxlength=\"maxlength\"\r\n        style=\"margin-right:10px;\"\r\n      >\r\n      </Input>\r\n      <Upload\r\n        :action=\"uploadFileUrl\"\r\n        :headers=\"accessToken\"\r\n        :on-success=\"handleSuccess\"\r\n        :on-error=\"handleError\"\r\n        :format=\"format\"\r\n        :accept=\"accept\"\r\n        :max-size=\"maxSize*1024\"\r\n        :on-format-error=\"handleFormatError\"\r\n        :on-exceeded-size=\"handleMaxSize\"\r\n        :before-upload=\"beforeUpload\"\r\n        :show-upload-list=\"false\"\r\n      >\r\n        <Button type=\"warning\" ghost :loading=\"loading\" :size=\"size\" :disabled=\"disabled\" :icon=\"icon\">{{buttonTitle}}</Button>\r\n      </Upload>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport \"viewerjs/dist/viewer.css\";\r\nimport Viewer from \"viewerjs\";\r\nimport { uploadFile } from \"@/api/index\";\r\nexport default {\r\n  name: \"uploadPicInput\",\r\n  props: {\r\n    value: String,\r\n    size: String,\r\n    placeholder: {\r\n      type: String,\r\n      default: \"可输入文件链接\"\r\n    },\r\n    buttonTitle: {\r\n      type: String,\r\n      default: \"上传文件\"\r\n    },\r\n    disabled: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    readonly: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    maxlength: Number,\r\n    icon: {\r\n      type: String,\r\n      default: \"ios-cloud-upload-outline\"\r\n    },\r\n    maxSize: {\r\n      type: Number,\r\n      default: 100\r\n    },\r\n    accept: {\r\n      type: String,\r\n      default: \".pdf\"\r\n    }\r\n  },\r\n  computed: {\r\n    format() {\r\n      if (this.accept) {\r\n        let format = [];\r\n        this.accept.split(\",\").forEach(e => {\r\n          format.push(e.replace(\".\", \"\").replace(\" \", \"\"));\r\n        });\r\n        return format;\r\n      } else {\r\n        return [];\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      accessToken: {},\r\n      currentValue: this.value,\r\n      loading: false,\r\n      uploadFileUrl: uploadFile\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.accessToken = {\r\n        accessToken: this.getStore(\"accessToken\")\r\n      };\r\n    },\r\n    handleFormatError(file) {\r\n      this.loading = false;\r\n      this.$Notice.warning({\r\n        title: \"不支持的文件格式\",\r\n        desc:\r\n          \"所选文件‘ \" +\r\n          file.name +\r\n          \" ’格式不正确, 请选择 \"+this.accept+\" 格式文件\"\r\n      });\r\n    },\r\n    handleMaxSize(file) {\r\n      this.loading = false;\r\n      this.$Notice.warning({\r\n        title: \"文件大小过大\",\r\n        desc:\r\n          \"所选文件‘ \" +\r\n          file.name +\r\n          \" ’大小过大, 不得超过 \" +\r\n          this.maxSize +\r\n          \"M.\"\r\n      });\r\n    },\r\n    beforeUpload() {\r\n      this.loading = true;\r\n      return true;\r\n    },\r\n    handleSuccess(res, file) {\r\n      this.loading = false;\r\n      if (res.success) {\r\n        this.currentValue = res.result;\r\n        this.$emit(\"input\", this.currentValue);\r\n        this.$emit(\"on-change\", this.currentValue);\r\n      } else {\r\n        this.$Message.error(res.message);\r\n      }\r\n    },\r\n    handleError(error, file, fileList) {\r\n      this.loading = false;\r\n      this.$Message.error(error.toString());\r\n    },\r\n    handleChange(v) {\r\n      this.$emit(\"input\", this.currentValue);\r\n      this.$emit(\"on-change\", this.currentValue);\r\n    },\r\n    setCurrentValue(value) {\r\n      if (value === this.currentValue) {\r\n        return;\r\n      }\r\n      this.currentValue = value;\r\n      this.$emit(\"on-change\", this.currentValue);\r\n    }\r\n  },\r\n  watch: {\r\n    value(val) {\r\n      this.setCurrentValue(val);\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  }\r\n};\r\n</script>\r\n\r\n"]}]}