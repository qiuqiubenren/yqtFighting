{"remainingRequest":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\graduateSys\\registration\\front\\src\\views\\dict\\dict\\index.vue?vue&type=style&index=0&id=70f0f908&lang=less","dependencies":[{"path":"D:\\graduateSys\\registration\\front\\src\\views\\dict\\dict\\index.vue","mtime":1743403543380},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1739857216827},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1739857212421},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":1739857212963},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\less-loader\\dist\\cjs.js","mtime":1739857239884},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1739857231742},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1739857212415}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLml2dS10YWJsZSB0ZCB7DQogICAgaGVpZ2h0OiAzOHB4ICFpbXBvcnRhbnQ7DQp9DQoNCi5pdnUtdGFibGUtY2VsbC13aXRoLWV4cGFuZCB7DQogICAgaGVpZ2h0OiAzOHB4ICFpbXBvcnRhbnQ7DQogICAgbGluZS1oZWlnaHQ6IDM4cHggIWltcG9ydGFudDsNCn0NCg0KLml2dS10YWJsZSAucm93Q2xhc3NOYW1lQ29sb3IgdGQgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNiMGIzYjYgIWltcG9ydGFudDsNCiAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50Ow0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwqBA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/dict/dict","sourcesContent":["<template>\r\n<div class=\"search\">\r\n    <Card>\r\n        <Row type=\"flex\" justify=\"space-between\">\r\n            <Col v-if=\"expand\" span=\"4\">\r\n            <Row class=\"operation\">\r\n                <Button @click=\"refreshDict\" type=\"success\" ghost size=\"small\">搜索</Button>\r\n                <Button @click=\"addDcit\" type=\"info\" ghost size=\"small\">添加</Button>\r\n                <Button @click=\"editDcit\" type=\"warning\" ghost size=\"small\" :disabled=\"!this.selectNode.id\">编辑</Button>\r\n                <Button @click=\"delDcit\" type=\"error\" ghost size=\"small\">删除</Button>\r\n            </Row>\r\n            <Row :gutter=\"16\">\r\n                <Alert type=\"success\" show-icon v-show=\"editTitle\">\r\n                    <span class=\"select-title\">{{editTitle}}</span>\r\n                    <a class=\"select-clear\" @click=\"cancelEdit\">取消</a>\r\n                </Alert>\r\n            </Row>\r\n            <Row :gutter=\"16\">\r\n                <Input v-model=\"searchKey\" suffix=\"ios-search\" @on-change=\"search\" placeholder=\"输入搜索字典\" clearable style=\"width:100%\" />\r\n            </Row>\r\n            <Row :gutter=\"16\">\r\n                <div class=\"tree-bar\" :style=\"{maxHeight: maxHeight}\">\r\n                    <Tree ref=\"tree\" :data=\"treeData\" @on-select-change=\"selectTree\" empty-text=\"没有数据字典\"></Tree>\r\n                    <Spin size=\"large\" fix v-if=\"treeLoading\"></Spin>\r\n                </div>\r\n            </Row>\r\n            </Col>\r\n            <div class=\"expand\">\r\n                <Icon :type=\"expandIcon\" size=\"16\" class=\"icon\" @click=\"changeExpand\" />\r\n            </div>\r\n            <Col :span=\"span\">\r\n            <Row :gutter=\"16\">\r\n                <Form ref=\"searchForm\" :model=\"searchForm\" inline :label-width=\"0\">\r\n                    <Form-item label=\"\">\r\n                        <Input type=\"text\" v-model=\"searchForm.title\" placeholder=\"数据名称\" clearable style=\"width: 120px\" />\r\n                    </Form-item>\r\n                    <Form-item label=\"\">\r\n                        <Input type=\"text\" v-model=\"searchForm.value\" placeholder=\"数据值\" clearable style=\"width: 120px\" />\r\n                    </Form-item>\r\n                    <Form-item label=\"\">\r\n                        <Input type=\"text\" v-model=\"searchForm.description\" placeholder=\"数据描述\" clearable style=\"width: 120px\" />\r\n                    </Form-item>\r\n                    <Form-item label=\"\">\r\n                        <Select v-model=\"searchForm.status\" placeholder=\"状态\" clearable style=\"width: 120px\">\r\n                            <Option value=\"0\">正常</Option>\r\n                            <Option value=\"-1\">禁用</Option>\r\n                        </Select>\r\n                    </Form-item>\r\n                    <Form-item class=\"br\">\r\n                        <Button @click=\"handleSearch\" ghost type=\"info\" icon=\"ios-search\" size=\"small\">搜索数据</Button>\r\n                        <Button @click=\"handleReset\" ghost type=\"warning\" icon=\"md-refresh\" size=\"small\">重置数据</Button>\r\n                        <Button @click=\"add\" ghost type=\"success\" icon=\"md-add\" size=\"small\">添加数据</Button>\r\n                        <Button @click=\"delAll\" ghost type=\"error\" icon=\"md-trash\" size=\"small\">删除数据</Button>\r\n                    </Form-item>\r\n                    <Alert type=\"success\" show-icon v-show=\"selectCount > 0\">\r\n                        已选择\r\n                        <span class=\"select-count\">{{selectCount}}</span> 项\r\n                        <a class=\"select-clear\" @click=\"clearSelectAll\">清空</a>\r\n                    </Alert>\r\n                </Form>\r\n            </Row>\r\n            <Row class=\"operation\">\r\n            </Row>\r\n            <Row>\r\n                <Table :loading=\"loading\" stripe border :columns=\"columns\" :data=\"data\" sortable=\"custom\" @on-sort-change=\"changeSort\" @on-selection-change=\"showSelect\" ref=\"table\" @on-row-click=\"rowClick\" :row-class-name=\"rowClassName\"></Table>\r\n            </Row>\r\n            <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n                <Page :current=\"searchForm.pageNumber\" :total=\"total\" :page-size=\"searchForm.pageSize\" @on-change=\"changePage\" @on-page-size-change=\"changePageSize\" :page-size-opts=\"[10,20,50]\" size=\"small\" show-total show-elevator show-sizer></Page>\r\n            </Row>\r\n            </Col>\r\n        </Row>\r\n    </Card>\r\n\r\n    <Modal :title=\"dictModalTitle\" v-model=\"dictModalVisible\" :mask-closable=\"false\" :width=\"500\">\r\n        <Form ref=\"dictForm\" :model=\"dictForm\" :label-width=\"85\" :rules=\"dictFormValidate\">\r\n            <FormItem label=\"字典名称\" prop=\"title\">\r\n                <Input v-model=\"dictForm.title\" />\r\n            </FormItem>\r\n            <FormItem label=\"字典类型\" prop=\"type\" class=\"block-tool\">\r\n                <Tooltip placement=\"right\" :max-width=\"220\" transfer content=\"建议英文名且需唯一 非开发人员谨慎修改\">\r\n                    <Input v-model=\"dictForm.type\" />\r\n                </Tooltip>\r\n            </FormItem>\r\n            <FormItem label=\"备注\" prop=\"description\">\r\n                <Input v-model=\"dictForm.description\" />\r\n            </FormItem>\r\n            <FormItem label=\"排序值\" prop=\"sortOrder\">\r\n                <Tooltip trigger=\"hover\" placement=\"right\" content=\"值越小越靠前，支持小数\">\r\n                    <InputNumber :max=\"1000\" :min=\"0\" v-model=\"dictForm.sortOrder\"></InputNumber>\r\n                </Tooltip>\r\n            </FormItem>\r\n        </Form>\r\n        <div slot=\"footer\">\r\n            <Button type=\"text\" @click=\"dictModalVisible=false\">取消</Button>\r\n            <Button type=\"primary\" :loading=\"submitLoading\" @click=\"handelSubmitDict\">提交</Button>\r\n        </div>\r\n    </Modal>\r\n\r\n    <Modal :title=\"modalTitle\" v-model=\"modalVisible\" :mask-closable=\"false\" :width=\"500\">\r\n        <Form ref=\"form\" :model=\"form\" :label-width=\"80\" :rules=\"formValidate\">\r\n            <FormItem label=\"名称\" prop=\"title\">\r\n                <Input v-model=\"form.title\" />\r\n            </FormItem>\r\n            <FormItem label=\"数据值\" prop=\"value\">\r\n                <Input v-model=\"form.value\" />\r\n            </FormItem>\r\n            <FormItem label=\"备注\" prop=\"description\">\r\n                <Input v-model=\"form.description\" />\r\n            </FormItem>\r\n            <FormItem label=\"排序值\" prop=\"sortOrder\">\r\n                <Tooltip trigger=\"hover\" placement=\"right\" content=\"值越小越靠前，支持小数\">\r\n                    <InputNumber :max=\"1000\" :min=\"0\" v-model=\"form.sortOrder\"></InputNumber>\r\n                </Tooltip>\r\n            </FormItem>\r\n            <FormItem label=\"是否启用\" prop=\"status\">\r\n                <i-switch size=\"large\" v-model=\"form.status\" :true-value=\"0\" :false-value=\"-1\">\r\n                    <span slot=\"open\">启用</span>\r\n                    <span slot=\"close\">禁用</span>\r\n                </i-switch>\r\n            </FormItem>\r\n        </Form>\r\n        <div slot=\"footer\">\r\n            <Button type=\"text\" @click=\"modalVisible=false\">取消</Button>\r\n            <Button type=\"primary\" :loading=\"submitLoading\" @click=\"handelSubmit\">提交</Button>\r\n        </div>\r\n    </Modal>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n    getAllDictList,\r\n    addDict,\r\n    editDict,\r\n    deleteDict,\r\n    searchDict,\r\n    getAllDictDataList,\r\n    addDictData,\r\n    editDictData,\r\n    deleteData\r\n} from \"./api.js\";\r\nexport default {\r\n    name: \"dic-manage\",\r\n    data() {\r\n        return {\r\n          selected: [\r\n                \"选择\",\r\n                \"编号\",\r\n                \"所属字典\",\r\n                \"键\",\r\n                \"值\",\r\n                \"描述\",\r\n                \"排序\",\r\n                \"是否禁用\",\r\n                \"操作\"\r\n          ],\r\n            treeLoading: false, // 树加载状态\r\n            maxHeight: \"500px\",\r\n            loading: false, // 表格加载状态\r\n            editTitle: \"\", // 编辑节点名称\r\n            searchKey: \"\", // 搜索树\r\n            expand: true,\r\n            span: 18,\r\n            expandIcon: \"md-arrow-round-back\",\r\n            selectNode: {},\r\n            treeData: [], // 树数据\r\n            selectCount: 0, // 多选计数\r\n            selectList: [], // 多选数据\r\n            searchForm: {\r\n                // 搜索框对应data对象\r\n                name: \"\",\r\n                status: \"\",\r\n                pageNumber: 1, // 当前页数\r\n                pageSize: 10, // 页面大小\r\n                sort: \"sortOrder\", // 默认排序字段\r\n                order: \"asc\" // 默认排序方式\r\n            },\r\n            modalType: 0, // 添加或编辑标识\r\n            modalVisible: false, // 添加或编辑显示\r\n            dictModalVisible: false,\r\n            dictModalTitle: \"\",\r\n            modalTitle: \"\", // 添加或编辑标题\r\n            dictForm: {\r\n                title: \"\",\r\n                type: \"\",\r\n                description: \"\",\r\n                sortOrder: 0\r\n            },\r\n            form: {\r\n                // 添加或编辑表单对象初始化数据\r\n                title: \"\",\r\n                value: \"\",\r\n                status: 0,\r\n                description: \"\",\r\n                sortOrder: 0\r\n            },\r\n            dictFormValidate: {\r\n                // 表单验证规则\r\n                title: [{\r\n                    required: true,\r\n                    message: \"不能为空\",\r\n                    trigger: \"blur\"\r\n                }],\r\n                type: [{\r\n                    required: true,\r\n                    message: \"不能为空\",\r\n                    trigger: \"blur\"\r\n                }],\r\n                sortOrder: [{\r\n                    required: true,\r\n                    type: \"number\",\r\n                    message: \"排序值不能为空\",\r\n                    trigger: \"blur\"\r\n                }]\r\n            },\r\n            formValidate: {\r\n                // 表单验证规则\r\n                title: [{\r\n                    required: true,\r\n                    message: \"不能为空\",\r\n                    trigger: \"blur\"\r\n                }],\r\n                value: [{\r\n                    required: true,\r\n                    message: \"不能为空\",\r\n                    trigger: \"blur\"\r\n                }],\r\n                sortOrder: [{\r\n                    required: true,\r\n                    type: \"number\",\r\n                    message: \"排序值不能为空\",\r\n                    trigger: \"blur\"\r\n                }]\r\n            },\r\n            columns: [{\r\n                    title: \"选择\",\r\n                    type: \"selection\",\r\n                    minWidth: 60,\r\n                    align: \"center\"\r\n                },\r\n                {\r\n                    title: \"编号\",\r\n                    type: \"index\",\r\n                    minWidth: 90,\r\n                    align: \"center\"\r\n                },\r\n                {\r\n                    title: \"所属字典\",\r\n                    key: \"dictName\",\r\n                    minWidth: 120,\r\n                    sortable: true\r\n                },\r\n                {\r\n                    title: \"键\",\r\n                    key: \"title\",\r\n                    minWidth: 120,\r\n                    sortable: true\r\n                },\r\n                {\r\n                    title: \"值\",\r\n                    key: \"value\",\r\n                    minWidth: 120,\r\n                    sortable: true\r\n                },\r\n                {\r\n                    title: \"描述\",\r\n                    key: \"description\",\r\n                    minWidth: 120,\r\n                    sortable: true\r\n                },\r\n                {\r\n                    title: \"排序\",\r\n                    key: \"sortOrder\",\r\n                    minWidth: 90,\r\n                    sortable: true,\r\n                    sortType: \"asc\"\r\n                },\r\n                {\r\n                    title: \"是否禁用\",\r\n                    key: \"status\",\r\n                    align: \"center\",\r\n                    minWidth: 120,\r\n                    render: (h, params) => {\r\n                        return h(\"div\", [\r\n                            h(\r\n                                \"Tag\", {\r\n                                    props: {\r\n                                        color: (params.row.status == 0 ? \"green\" : \"red\"),\r\n                                        size: \"medium\"\r\n                                    }\r\n                                },\r\n                                (params.row.status == 0 ? \"启用\" : \"禁用\")\r\n                            ),\r\n                        ]);\r\n                    }\r\n                },\r\n                {\r\n                    title: \"创建时间\",\r\n                    key: \"createTime\",\r\n                    minWidth: 180,\r\n                    sortable: true\r\n                },\r\n                {\r\n                    title: \"操作\",\r\n                    key: \"action\",\r\n                    width: 180,\r\n                    align: \"center\",\r\n                    fixed: \"right\",\r\n                    render: (h, params) => {\r\n                        return h(\"div\", [\r\n                            h(\r\n                                \"Button\", {\r\n                                    props: {\r\n                                        type: \"primary\",\r\n                                        size: \"small\",\r\n                                        ghost: true,\r\n                                        icon: \"ios-brush\"\r\n                                    },\r\n                                    style: {\r\n                                        marginRight: \"5px\"\r\n                                    },\r\n                                    on: {\r\n                                        click: () => {\r\n                                            this.edit(params.row);\r\n                                        }\r\n                                    }\r\n                                },\r\n                                \"编辑\"\r\n                            ),\r\n                            h(\r\n                                \"Button\", {\r\n                                    props: {\r\n                                        type: \"error\",\r\n                                        size: \"small\",\r\n                                        ghost: true,\r\n                                        icon: \"md-close\"\r\n                                    },\r\n                                    on: {\r\n                                        click: () => {\r\n                                            this.remove(params.row);\r\n                                        }\r\n                                    }\r\n                                },\r\n                                \"删除\"\r\n                            )\r\n                        ]);\r\n                    }\r\n                }\r\n            ],\r\n            submitLoading: false, // 添加或编辑提交状态\r\n            data: [], //表单数据\r\n            total: 0, // 表单数据总数\r\n            selectRow: {}\r\n        };\r\n    },\r\n    methods: {\r\n        init() {\r\n            // 获取树数据\r\n            this.getAllDict();\r\n            // 获取表单数据\r\n            this.getDataList();\r\n        },\r\n        rowClick(row, index) {\r\n            this.selectRow = row;\r\n        },\r\n        rowClassName(row, index) {\r\n            if (row.id == this.selectRow.id) {\r\n                return \"rowClassNameColor\";\r\n            }\r\n            return \"\";\r\n        },\r\n        getAllDict() {\r\n            this.treeLoading = true;\r\n            getAllDictList().then(res => {\r\n                this.treeLoading = false;\r\n                if (res.success) {\r\n                    this.treeData = res.result;\r\n                }\r\n            });\r\n        },\r\n        search() {\r\n            // 搜索树\r\n            if (this.searchKey) {\r\n                this.treeLoading = true;\r\n                searchDict({\r\n                    key: this.searchKey\r\n                }).then(res => {\r\n                    this.treeLoading = false;\r\n                    if (res.success) {\r\n                        this.treeData = res.result;\r\n                    }\r\n                });\r\n            } else {\r\n                // 为空重新加载\r\n                this.getAllDict();\r\n            }\r\n        },\r\n        selectTree(v) {\r\n            if (v.length > 0) {\r\n                this.$refs.dictForm.resetFields();\r\n                // 转换null为\"\"\r\n                for (let attr in v[0]) {\r\n                    if (v[0][attr] == null) {\r\n                        v[0][attr] = \"\";\r\n                    }\r\n                }\r\n                let str = JSON.stringify(v[0]);\r\n                let data = JSON.parse(str);\r\n                this.selectNode = data;\r\n                this.dictForm = data;\r\n                this.editTitle = data.title + \"(\" + data.type + \")\";\r\n                // 重新加载表\r\n                this.searchForm.pageNumber = 1;\r\n                this.searchForm.pageSize = 10;\r\n                this.getDataList();\r\n            } else {\r\n                this.cancelEdit();\r\n            }\r\n        },\r\n        cancelEdit() {\r\n            let data = this.$refs.tree.getSelectedNodes()[0];\r\n            if (data) {\r\n                data.selected = false;\r\n            }\r\n            // 取消选择后获取全部数据\r\n            this.selectNode = {};\r\n            this.editTitle = \"\";\r\n            this.getDataList();\r\n        },\r\n        changeSelect(v) {\r\n            this.selectCount = v.length;\r\n            this.selectList = v;\r\n        },\r\n        changeExpand() {\r\n            this.expand = !this.expand;\r\n            if (this.expand) {\r\n                this.expandIcon = \"md-arrow-round-back\";\r\n                this.span = 19;\r\n            } else {\r\n                this.expandIcon = \"md-arrow-round-forward\";\r\n                this.span = 23;\r\n            }\r\n        },\r\n        changePage(v) {\r\n            this.searchForm.pageNumber = v;\r\n            this.getDataList();\r\n            this.clearSelectAll();\r\n        },\r\n        changePageSize(v) {\r\n            this.searchForm.pageSize = v;\r\n            this.getDataList();\r\n        },\r\n        getDataList() {\r\n            this.loading = true;\r\n            if (this.selectNode.id) {\r\n                this.searchForm.dictId = this.selectNode.id;\r\n            } else {\r\n                delete this.searchForm.dictId;\r\n            }\r\n            if (!this.searchForm.status) {\r\n                this.searchForm.status = \"\";\r\n            }\r\n            getAllDictDataList(this.searchForm).then(res => {\r\n                this.loading = false;\r\n                if (res.success) {\r\n                    this.data = res.result.records;\r\n                    this.total = res.result.total;\r\n                }\r\n            });\r\n        },\r\n        handleSearch() {\r\n            this.searchForm.pageNumber = 1;\r\n            this.searchForm.pageSize = 10;\r\n            this.getDataList();\r\n        },\r\n        handleReset() {\r\n            this.$refs.searchForm.resetFields();\r\n            this.searchForm.pageNumber = 1;\r\n            this.searchForm.pageSize = 10;\r\n            // 重新加载数据\r\n            this.getDataList();\r\n        },\r\n        changeSort(e) {\r\n            this.searchForm.sort = e.key;\r\n            this.searchForm.order = e.order;\r\n            if (e.order == \"normal\") {\r\n                this.searchForm.order = \"\";\r\n            }\r\n            this.getDataList();\r\n        },\r\n        showSelect(e) {\r\n            this.selectList = e;\r\n            this.selectCount = e.length;\r\n        },\r\n        clearSelectAll() {\r\n            this.$refs.table.selectAll(false);\r\n        },\r\n        refreshDict() {\r\n            this.getAllDict();\r\n            this.selectNode = {};\r\n            this.editTitle = \"\";\r\n            this.getDataList();\r\n        },\r\n        addDcit() {\r\n            this.modalType = 0;\r\n            this.dictModalTitle = \"添加字典\";\r\n            this.$refs.dictForm.resetFields();\r\n            this.dictModalVisible = true;\r\n        },\r\n        editDcit() {\r\n            this.modalType = 1;\r\n            this.dictModalTitle = \"编辑字典\";\r\n            this.dictModalVisible = true;\r\n        },\r\n        delDcit() {\r\n            if (!this.selectNode.id) {\r\n                this.$Message.warning(\"您还未选择要删除的字典\");\r\n                return;\r\n            }\r\n            this.$Modal.confirm({\r\n                title: \"确认删除\",\r\n                loading: true,\r\n                content: \"您确认要删除 \" + this.selectNode.title + \" ?\",\r\n                onOk: () => {\r\n                    // 删除\r\n                    deleteDict({\r\n                        ids: this.selectNode.id\r\n                    }).then(res => {\r\n                        this.$Modal.remove();\r\n                        if (res.success) {\r\n                            this.$Message.success(\"操作成功\");\r\n                            this.refreshDict();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        add() {\r\n            if (!this.selectNode.id) {\r\n                this.$Message.warning(\"请先选择一个字典类别\");\r\n                return;\r\n            }\r\n            this.modalType = 0;\r\n            this.modalTitle = \"添加字典 \" + this.editTitle + \" 的数据\";\r\n            this.$refs.form.resetFields();\r\n            this.modalVisible = true;\r\n        },\r\n        edit(v) {\r\n            this.modalType = 1;\r\n            this.modalTitle = \"编辑字典 \" + this.editTitle + \" 的数据\";\r\n            this.$refs.form.resetFields();\r\n            // 转换null为\"\"\r\n            for (let attr in v) {\r\n                if (v[attr] == null) {\r\n                    v[attr] = \"\";\r\n                }\r\n            }\r\n            let str = JSON.stringify(v);\r\n            let data = JSON.parse(str);\r\n            this.form = data;\r\n            this.modalVisible = true;\r\n        },\r\n        handelSubmitDict() {\r\n            this.$refs.dictForm.validate(valid => {\r\n                if (valid) {\r\n                    this.submitLoading = true;\r\n                    if (this.modalType == 0) {\r\n                        // 添加 避免编辑后传入id等数据 记得删除\r\n                        delete this.dictForm.id;\r\n                        addDict(this.dictForm).then(res => {\r\n                            this.submitLoading = false;\r\n                            if (res.success) {\r\n                                this.$Message.success(\"操作成功\");\r\n                                this.getAllDict();\r\n                                this.dictModalVisible = false;\r\n                            }\r\n                        });\r\n                    } else if (this.modalType == 1) {\r\n                        // 编辑\r\n                        editDict(this.dictForm).then(res => {\r\n                            this.submitLoading = false;\r\n                            if (res.success) {\r\n                                this.$Message.success(\"操作成功\");\r\n                                this.getAllDict();\r\n                                this.dictModalVisible = false;\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        handelSubmit() {\r\n            this.$refs.form.validate(valid => {\r\n                if (valid) {\r\n                    this.submitLoading = true;\r\n                    if (this.modalType == 0) {\r\n                        // 添加 避免编辑后传入id等数据 记得删除\r\n                        delete this.form.id;\r\n                        this.form.dictId = this.selectNode.id;\r\n                        addDictData(this.form).then(res => {\r\n                            this.submitLoading = false;\r\n                            if (res.success) {\r\n                                this.$Message.success(\"操作成功\");\r\n                                this.getDataList();\r\n                                this.modalVisible = false;\r\n                            }\r\n                        });\r\n                    } else if (this.modalType == 1) {\r\n                        // 编辑\r\n                        editDictData(this.form).then(res => {\r\n                            this.submitLoading = false;\r\n                            if (res.success) {\r\n                                this.$Message.success(\"操作成功\");\r\n                                this.getDataList();\r\n                                this.modalVisible = false;\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        remove(v) {\r\n            this.$Modal.confirm({\r\n                title: \"确认删除\",\r\n                content: \"您确认要删除 \" + v.title + \" ?\",\r\n                loading: true,\r\n                onOk: () => {\r\n                    // 删除\r\n                    deleteData({\r\n                        ids: v.id\r\n                    }).then(res => {\r\n                        this.$Modal.remove();\r\n                        if (res.success) {\r\n                            this.$Message.success(\"操作成功\");\r\n                            this.getDataList();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        delAll() {\r\n            if (this.selectCount <= 0) {\r\n                this.$Message.warning(\"您还未选择要删除的数据\");\r\n                return;\r\n            }\r\n            this.$Modal.confirm({\r\n                title: \"确认删除\",\r\n                content: \"您确认要删除所选的 \" + this.selectCount + \" 条数据?\",\r\n                loading: true,\r\n                onOk: () => {\r\n                    let ids = \"\";\r\n                    this.selectList.forEach(function (e) {\r\n                        ids += e.id + \",\";\r\n                    });\r\n                    ids = ids.substring(0, ids.length - 1);\r\n                    // 批量删除\r\n                    deleteData({\r\n                        ids: ids\r\n                    }).then(res => {\r\n                        this.$Modal.remove();\r\n                        if (res.success) {\r\n                            this.$Message.success(\"操作成功\");\r\n                            this.clearSelectAll();\r\n                            this.getDataList();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n    mounted() {\r\n        // 计算高度\r\n        let height = document.documentElement.clientHeight;\r\n        this.maxHeight = Number(height - 287) + \"px\";\r\n        this.init();\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.ivu-table td {\r\n    height: 38px !important;\r\n}\r\n\r\n.ivu-table-cell-with-expand {\r\n    height: 38px !important;\r\n    line-height: 38px !important;\r\n}\r\n\r\n.ivu-table .rowClassNameColor td {\r\n    background-color: #b0b3b6 !important;\r\n    color: #ffffff !important;\r\n}\r\n</style>\r\n"]}]}