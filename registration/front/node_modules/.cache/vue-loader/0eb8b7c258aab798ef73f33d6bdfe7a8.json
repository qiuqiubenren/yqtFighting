{"remainingRequest":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\graduateSys\\registration\\front\\src\\views\\template\\file-upload.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\graduateSys\\registration\\front\\src\\views\\template\\file-upload.vue","mtime":1743403543362},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1739857231742},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1739857230815},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1739857231742},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1739857212415}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgew0KICAgIHVwbG9hZEZpbGUNCn0gZnJvbSAiQC9hcGkvaW5kZXgiOw0KZXhwb3J0IGRlZmF1bHQgew0KICAgIG5hbWU6ICJmaWxlVXBsb2FkIiwNCiAgICBwcm9wczogew0KICAgICAgICB2YWx1ZTogT2JqZWN0LA0KICAgICAgICBzaXplOiBTdHJpbmcsDQogICAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgICAgZ2hvc3Q6IHsNCiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICBkaXNhYmxlZDogew0KICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHNoYXBlOiBTdHJpbmcsDQogICAgICAgIGljb246IHsNCiAgICAgICAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgICAgICAgIGRlZmF1bHQ6ICJpb3MtY2xvdWQtdXBsb2FkLW91dGxpbmUiDQogICAgICAgIH0sDQogICAgICAgIHRleHQ6IHsNCiAgICAgICAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgICAgICAgIGRlZmF1bHQ6ICLkuIrkvKDmlofku7YiDQogICAgICAgIH0sDQogICAgICAgIG1heFNpemU6IHsNCiAgICAgICAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgICAgICAgIGRlZmF1bHQ6IDUNCiAgICAgICAgfSwNCiAgICAgICAgYWNjZXB0OiBTdHJpbmcNCiAgICB9LA0KICAgIGNvbXB1dGVkOiB7DQogICAgICAgIGZvcm1hdCgpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmFjY2VwdCkgew0KICAgICAgICAgICAgICAgIGxldCBmb3JtYXQgPSBbXTsNCiAgICAgICAgICAgICAgICB0aGlzLmFjY2VwdC5zcGxpdCgiLCIpLmZvckVhY2goZSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1hdC5wdXNoKGUucmVwbGFjZSgiLiIsICIiKS5yZXBsYWNlKCIgIiwgIiIpKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gW107DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9LA0KICAgIGRhdGEoKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBhY2Nlc3NUb2tlbjoge30sDQogICAgICAgICAgICB0aXRsZTogIueCueWHu+S4i+i9vSIsDQogICAgICAgICAgICBjdXJyZW50VmFsdWU6IHRoaXMudmFsdWUsDQogICAgICAgICAgICBsb2FkaW5nOiBmYWxzZSwNCiAgICAgICAgICAgIHVwbG9hZEZpbGVVcmw6IHVwbG9hZEZpbGUNCiAgICAgICAgfTsNCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgICAgaW5pdCgpIHsNCiAgICAgICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSB7DQogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IHRoaXMuZ2V0U3RvcmUoImFjY2Vzc1Rva2VuIikNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQogICAgICAgIGRvd25sb2FkKCkgew0KICAgICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRWYWx1ZS51cmwpIHsNCiAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKCLml6DmlYjnmoTpk77mjqUiKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICB3aW5kb3cub3BlbigNCiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS51cmwgKw0KICAgICAgICAgICAgICAgICI/YXR0bmFtZT0mcmVzcG9uc2UtY29udGVudC10eXBlPWFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSZmaWxlbmFtZT0iICsNCiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5uYW1lDQogICAgICAgICAgICApOw0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVGb3JtYXRFcnJvcihmaWxlKSB7DQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMuJE5vdGljZS53YXJuaW5nKHsNCiAgICAgICAgICAgICAgICB0aXRsZTogIuS4jeaUr+aMgeeahOaWh+S7tuagvOW8jyIsDQogICAgICAgICAgICAgICAgZGVzYzogIuaJgOmAieaWh+S7tuKAmCAiICsNCiAgICAgICAgICAgICAgICAgICAgZmlsZS5uYW1lICsNCiAgICAgICAgICAgICAgICAgICAgIiDigJnmoLzlvI/kuI3mraPnoa4sIOivt+mAieaLqSAiICsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY2NlcHQgKw0KICAgICAgICAgICAgICAgICAgICAiIOagvOW8j+aWh+S7tiINCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVNYXhTaXplKGZpbGUpIHsNCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgdGhpcy4kTm90aWNlLndhcm5pbmcoew0KICAgICAgICAgICAgICAgIHRpdGxlOiAi5paH5Lu25aSn5bCP6L+H5aSnIiwNCiAgICAgICAgICAgICAgICBkZXNjOiAi5omA6YCJ5paH5Lu24oCYICIgKw0KICAgICAgICAgICAgICAgICAgICBmaWxlLm5hbWUgKw0KICAgICAgICAgICAgICAgICAgICAiIOKAmeWkp+Wwj+i/h+Wkpywg5LiN5b6X6LaF6L+HICIgKw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1heFNpemUgKw0KICAgICAgICAgICAgICAgICAgICAiTS4iDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICAgICAgYmVmb3JlVXBsb2FkKCkgew0KICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVTdWNjZXNzKHJlcywgZmlsZSkgew0KICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgdXJsOiByZXMucmVzdWx0LA0KICAgICAgICAgICAgICAgICAgICBuYW1lOiBmaWxlLm5hbWUsDQogICAgICAgICAgICAgICAgICAgIHNpemU6IGZpbGUuc2l6ZQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgdGhpcy50aXRsZSA9DQogICAgICAgICAgICAgICAgICAgICLngrnlh7vkuIvovb0oIiArDQogICAgICAgICAgICAgICAgICAgICgoZmlsZS5zaXplICogMS4wKSAvICgxMDI0ICogMTAyNCkpLnRvRml4ZWQoMikgKw0KICAgICAgICAgICAgICAgICAgICAiIE1CKSI7DQogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgiaW5wdXQiLCB0aGlzLmN1cnJlbnRWYWx1ZSk7DQogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgib24tY2hhbmdlIiwgdGhpcy5jdXJyZW50VmFsdWUpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKHJlcy5tZXNzYWdlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlRXJyb3IoZXJyb3IsIGZpbGUsIGZpbGVMaXN0KSB7DQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IoZXJyb3IudG9TdHJpbmcoKSk7DQogICAgICAgIH0sDQogICAgICAgIGhhbmRsZUNoYW5nZSh2KSB7DQogICAgICAgICAgICB0aGlzLiRlbWl0KCJpbnB1dCIsIHRoaXMuY3VycmVudFZhbHVlKTsNCiAgICAgICAgICAgIHRoaXMuJGVtaXQoIm9uLWNoYW5nZSIsIHRoaXMuY3VycmVudFZhbHVlKTsNCiAgICAgICAgfSwNCiAgICAgICAgc2V0Q3VycmVudFZhbHVlKHZhbHVlKSB7DQogICAgICAgICAgICBpZiAodmFsdWUgPT09IHRoaXMuY3VycmVudFZhbHVlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPSB2YWx1ZTsNCiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRWYWx1ZS5zaXplKSB7DQogICAgICAgICAgICAgICAgdGhpcy50aXRsZSA9DQogICAgICAgICAgICAgICAgICAgICLngrnlh7vkuIvovb0oIiArDQogICAgICAgICAgICAgICAgICAgICgodGhpcy5jdXJyZW50VmFsdWUuc2l6ZSAqIDEuMCkgLyAoMTAyNCAqIDEwMjQpKS50b0ZpeGVkKDIpICsNCiAgICAgICAgICAgICAgICAgICAgIiBNQikiOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLnRpdGxlID0gIueCueWHu+S4i+i9vSI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLiRlbWl0KCJvbi1jaGFuZ2UiLCB0aGlzLmN1cnJlbnRWYWx1ZSk7DQogICAgICAgIH0NCiAgICB9LA0KICAgIHdhdGNoOiB7DQogICAgICAgIHZhbHVlKHZhbCkgew0KICAgICAgICAgICAgdGhpcy5zZXRDdXJyZW50VmFsdWUodmFsKTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgbW91bnRlZCgpIHsNCiAgICAgICAgdGhpcy5pbml0KCk7DQogICAgfQ0KfTsNCg=="},{"version":3,"sources":["file-upload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"file-upload.vue","sourceRoot":"src/views/template","sourcesContent":["<template>\r\n<div>\r\n    <div class=\"file-upload-wrap\">\r\n        <Upload :action=\"uploadFileUrl\" :headers=\"accessToken\" :on-success=\"handleSuccess\" :on-error=\"handleError\" :format=\"format\" :accept=\"accept\" :max-size=\"maxSize*1024\" :on-format-error=\"handleFormatError\" :on-exceeded-size=\"handleMaxSize\" :before-upload=\"beforeUpload\" :show-upload-list=\"false\" class=\"file-upload\">\r\n            <Button :loading=\"loading\" :type=\"type\" :ghost=\"ghost\" :shape=\"shape\" :size=\"size\" :disabled=\"disabled\" :icon=\"icon\">{{text}}</Button>\r\n        </Upload>\r\n        <Tooltip transfer :content=\"title\" placement=\"top\">\r\n            <a @click=\"download\">{{currentValue.name}}</a>\r\n        </Tooltip>\r\n    </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n    uploadFile\r\n} from \"@/api/index\";\r\nexport default {\r\n    name: \"fileUpload\",\r\n    props: {\r\n        value: Object,\r\n        size: String,\r\n        type: String,\r\n        ghost: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        disabled: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        shape: String,\r\n        icon: {\r\n            type: String,\r\n            default: \"ios-cloud-upload-outline\"\r\n        },\r\n        text: {\r\n            type: String,\r\n            default: \"上传文件\"\r\n        },\r\n        maxSize: {\r\n            type: Number,\r\n            default: 5\r\n        },\r\n        accept: String\r\n    },\r\n    computed: {\r\n        format() {\r\n            if (this.accept) {\r\n                let format = [];\r\n                this.accept.split(\",\").forEach(e => {\r\n                    format.push(e.replace(\".\", \"\").replace(\" \", \"\"));\r\n                });\r\n                return format;\r\n            } else {\r\n                return [];\r\n            }\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            accessToken: {},\r\n            title: \"点击下载\",\r\n            currentValue: this.value,\r\n            loading: false,\r\n            uploadFileUrl: uploadFile\r\n        };\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.accessToken = {\r\n                accessToken: this.getStore(\"accessToken\")\r\n            };\r\n        },\r\n        download() {\r\n            if (!this.currentValue.url) {\r\n                this.$Message.error(\"无效的链接\");\r\n                return;\r\n            }\r\n            window.open(\r\n                this.currentValue.url +\r\n                \"?attname=&response-content-type=application/octet-stream&filename=\" +\r\n                this.currentValue.name\r\n            );\r\n        },\r\n        handleFormatError(file) {\r\n            this.loading = false;\r\n            this.$Notice.warning({\r\n                title: \"不支持的文件格式\",\r\n                desc: \"所选文件‘ \" +\r\n                    file.name +\r\n                    \" ’格式不正确, 请选择 \" +\r\n                    this.accept +\r\n                    \" 格式文件\"\r\n            });\r\n        },\r\n        handleMaxSize(file) {\r\n            this.loading = false;\r\n            this.$Notice.warning({\r\n                title: \"文件大小过大\",\r\n                desc: \"所选文件‘ \" +\r\n                    file.name +\r\n                    \" ’大小过大, 不得超过 \" +\r\n                    this.maxSize +\r\n                    \"M.\"\r\n            });\r\n        },\r\n        beforeUpload() {\r\n            this.loading = true;\r\n            return true;\r\n        },\r\n        handleSuccess(res, file) {\r\n            this.loading = false;\r\n            if (res.success) {\r\n                this.currentValue = {\r\n                    url: res.result,\r\n                    name: file.name,\r\n                    size: file.size\r\n                };\r\n                this.title =\r\n                    \"点击下载(\" +\r\n                    ((file.size * 1.0) / (1024 * 1024)).toFixed(2) +\r\n                    \" MB)\";\r\n                this.$emit(\"input\", this.currentValue);\r\n                this.$emit(\"on-change\", this.currentValue);\r\n            } else {\r\n                this.$Message.error(res.message);\r\n            }\r\n        },\r\n        handleError(error, file, fileList) {\r\n            this.loading = false;\r\n            this.$Message.error(error.toString());\r\n        },\r\n        handleChange(v) {\r\n            this.$emit(\"input\", this.currentValue);\r\n            this.$emit(\"on-change\", this.currentValue);\r\n        },\r\n        setCurrentValue(value) {\r\n            if (value === this.currentValue) {\r\n                return;\r\n            }\r\n            this.currentValue = value;\r\n            if (this.currentValue.size) {\r\n                this.title =\r\n                    \"点击下载(\" +\r\n                    ((this.currentValue.size * 1.0) / (1024 * 1024)).toFixed(2) +\r\n                    \" MB)\";\r\n            } else {\r\n                this.title = \"点击下载\";\r\n            }\r\n            this.$emit(\"on-change\", this.currentValue);\r\n        }\r\n    },\r\n    watch: {\r\n        value(val) {\r\n            this.setCurrentValue(val);\r\n        }\r\n    },\r\n    mounted() {\r\n        this.init();\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.file-upload-wrap {\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .file-upload {\r\n        display: inline-block;\r\n        margin-right: 10px;\r\n    }\r\n}\r\n</style>\r\n"]}]}