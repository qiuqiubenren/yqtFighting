{"remainingRequest":"D:\\graduateSys\\registration\\front\\node_modules\\babel-loader\\lib\\index.js!D:\\graduateSys\\registration\\front\\src\\libs\\excel.js","dependencies":[{"path":"D:\\graduateSys\\registration\\front\\src\\libs\\excel.js","mtime":1739157381734},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1739857231742},{"path":"D:\\graduateSys\\registration\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1739857230815}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFhMU1ggZnJvbSAneGxzeCc7CmZ1bmN0aW9uIGF1dG9fd2lkdGgod3MsIGRhdGEpIHsKICBjb25zdCBjb2xXaWR0aCA9IGRhdGEubWFwKHJvdyA9PiByb3cubWFwKHZhbCA9PiB7CiAgICBpZiAodmFsID09IG51bGwpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICAnd2NoJzogMTAKICAgICAgfTsKICAgIH0gZWxzZSBpZiAodmFsLnRvU3RyaW5nKCkuY2hhckNvZGVBdCgwKSA+IDI1NSkgewogICAgICByZXR1cm4gewogICAgICAgICd3Y2gnOiB2YWwudG9TdHJpbmcoKS5sZW5ndGggKiAyCiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gewogICAgICAgICd3Y2gnOiB2YWwudG9TdHJpbmcoKS5sZW5ndGgKICAgICAgfTsKICAgIH0KICB9KSk7CiAgbGV0IHJlc3VsdCA9IGNvbFdpZHRoWzBdOwogIGZvciAobGV0IGkgPSAxOyBpIDwgY29sV2lkdGgubGVuZ3RoOyBpKyspIHsKICAgIGZvciAobGV0IGogPSAwOyBqIDwgY29sV2lkdGhbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgaWYgKHJlc3VsdFtqXVsnd2NoJ10gPCBjb2xXaWR0aFtpXVtqXVsnd2NoJ10pIHsKICAgICAgICByZXN1bHRbal1bJ3djaCddID0gY29sV2lkdGhbaV1bal1bJ3djaCddOwogICAgICB9CiAgICB9CiAgfQogIHdzWychY29scyddID0gcmVzdWx0Owp9CmZ1bmN0aW9uIGpzb25fdG9fYXJyYXkoa2V5LCBqc29uRGF0YSkgewogIHJldHVybiBqc29uRGF0YS5tYXAodiA9PiBrZXkubWFwKGogPT4gewogICAgcmV0dXJuIHZbal07CiAgfSkpOwp9CmZ1bmN0aW9uIGZpeGRhdGEoZGF0YSkgewogIGxldCBvID0gJyc7CiAgbGV0IGwgPSAwOwogIGNvbnN0IHcgPSAxMDI0MDsKICBmb3IgKDsgbCA8IGRhdGEuYnl0ZUxlbmd0aCAvIHc7ICsrbCkgbyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KGRhdGEuc2xpY2UobCAqIHcsIGwgKiB3ICsgdykpKTsKICBvICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkoZGF0YS5zbGljZShsICogdykpKTsKICByZXR1cm4gbzsKfQpmdW5jdGlvbiBnZXRfaGVhZGVyX3JvdyhzaGVldCkgewogIGNvbnN0IGhlYWRlcnMgPSBbXTsKICBjb25zdCByYW5nZSA9IFhMU1gudXRpbHMuZGVjb2RlX3JhbmdlKHNoZWV0WychcmVmJ10pOwogIGxldCBDOwogIGNvbnN0IFIgPSByYW5nZS5zLnI7CiAgZm9yIChDID0gcmFuZ2Uucy5jOyBDIDw9IHJhbmdlLmUuYzsgKytDKSB7CiAgICB2YXIgY2VsbCA9IHNoZWV0W1hMU1gudXRpbHMuZW5jb2RlX2NlbGwoewogICAgICBjOiBDLAogICAgICByOiBSCiAgICB9KV07CiAgICB2YXIgaGRyID0gJ1VOS05PV04gJyArIEM7CiAgICBpZiAoY2VsbCAmJiBjZWxsLnQpIGhkciA9IFhMU1gudXRpbHMuZm9ybWF0X2NlbGwoY2VsbCk7CiAgICBoZWFkZXJzLnB1c2goaGRyKTsKICB9CiAgcmV0dXJuIGhlYWRlcnM7Cn0KZXhwb3J0IGNvbnN0IGV4cG9ydF90YWJsZV90b19leGNlbCA9IChpZCwgZmlsZW5hbWUpID0+IHsKICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKICBjb25zdCB3YiA9IFhMU1gudXRpbHMudGFibGVfdG9fYm9vayh0YWJsZSk7CiAgWExTWC53cml0ZUZpbGUod2IsIGZpbGVuYW1lKTsKfTsKZXhwb3J0IGNvbnN0IGV4cG9ydF9qc29uX3RvX2V4Y2VsID0gKHsKICBkYXRhLAogIGtleSwKICB0aXRsZSwKICBmaWxlbmFtZSwKICBhdXRvV2lkdGgKfSkgPT4gewogIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpOwogIGRhdGEudW5zaGlmdCh0aXRsZSk7CiAgY29uc3Qgd3MgPSBYTFNYLnV0aWxzLmpzb25fdG9fc2hlZXQoZGF0YSwgewogICAgaGVhZGVyOiBrZXksCiAgICBza2lwSGVhZGVyOiB0cnVlCiAgfSk7CiAgaWYgKGF1dG9XaWR0aCkgewogICAgY29uc3QgYXJyID0ganNvbl90b19hcnJheShrZXksIGRhdGEpOwogICAgYXV0b193aWR0aCh3cywgYXJyKTsKICB9CiAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MsIGZpbGVuYW1lKTsKICBYTFNYLndyaXRlRmlsZSh3YiwgZmlsZW5hbWUgKyAnLnhsc3gnKTsKfTsKZXhwb3J0IGNvbnN0IGV4cG9ydF9hcnJheV90b19leGNlbCA9ICh7CiAga2V5LAogIGRhdGEsCiAgdGl0bGUsCiAgZmlsZW5hbWUsCiAgYXV0b1dpZHRoCn0pID0+IHsKICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsKICBjb25zdCBhcnIgPSBqc29uX3RvX2FycmF5KGtleSwgZGF0YSk7CiAgYXJyLnVuc2hpZnQodGl0bGUpOwogIGNvbnN0IHdzID0gWExTWC51dGlscy5hb2FfdG9fc2hlZXQoYXJyKTsKICBpZiAoYXV0b1dpZHRoKSB7CiAgICBhdXRvX3dpZHRoKHdzLCBhcnIpOwogIH0KICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3cywgZmlsZW5hbWUpOwogIFhMU1gud3JpdGVGaWxlKHdiLCBmaWxlbmFtZSArICcueGxzeCcpOwp9OwpleHBvcnQgY29uc3QgcmVhZCA9IChkYXRhLCB0eXBlKSA9PiB7CiAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoZGF0YSwgewogICAgdHlwZTogdHlwZQogIH0pOwogIGNvbnN0IGZpcnN0U2hlZXROYW1lID0gd29ya2Jvb2suU2hlZXROYW1lc1swXTsKICBjb25zdCB3b3Jrc2hlZXQgPSB3b3JrYm9vay5TaGVldHNbZmlyc3RTaGVldE5hbWVdOwogIGNvbnN0IGhlYWRlciA9IGdldF9oZWFkZXJfcm93KHdvcmtzaGVldCk7CiAgY29uc3QgcmVzdWx0cyA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3Jrc2hlZXQpOwogIHJldHVybiB7CiAgICBoZWFkZXIsCiAgICByZXN1bHRzCiAgfTsKfTsKZXhwb3J0IGRlZmF1bHQgewogIGV4cG9ydF90YWJsZV90b19leGNlbCwKICBleHBvcnRfYXJyYXlfdG9fZXhjZWwsCiAgZXhwb3J0X2pzb25fdG9fZXhjZWwsCiAgcmVhZAp9Ow=="},{"version":3,"names":["XLSX","auto_width","ws","data","colWidth","map","row","val","toString","charCodeAt","length","result","i","j","json_to_array","key","jsonData","v","fixdata","o","l","w","byteLength","String","fromCharCode","apply","Uint8Array","slice","get_header_row","sheet","headers","range","utils","decode_range","C","R","s","r","c","e","cell","encode_cell","hdr","t","format_cell","push","export_table_to_excel","id","filename","table","document","getElementById","wb","table_to_book","writeFile","export_json_to_excel","title","autoWidth","book_new","unshift","json_to_sheet","header","skipHeader","arr","book_append_sheet","export_array_to_excel","aoa_to_sheet","read","type","workbook","firstSheetName","SheetNames","worksheet","Sheets","results","sheet_to_json"],"sources":["D:/graduateSys/registration/front/src/libs/excel.js"],"sourcesContent":["import XLSX from 'xlsx';\r\n\r\nfunction auto_width(ws, data){\r\n    const colWidth = data.map(row => row.map(val => {\r\n        if (val == null) {\r\n            return {'wch': 10};\r\n        }\r\n        else if (val.toString().charCodeAt(0) > 255) {\r\n            return {'wch': val.toString().length * 2};\r\n        } else {\r\n            return {'wch': val.toString().length};\r\n        }\r\n    }))\r\n    let result = colWidth[0];\r\n    for (let i = 1; i < colWidth.length; i++) {\r\n        for (let j = 0; j < colWidth[i].length; j++) {\r\n            if (result[j]['wch'] < colWidth[i][j]['wch']) {\r\n                result[j]['wch'] = colWidth[i][j]['wch'];\r\n            }\r\n        }\r\n    }\r\n    ws['!cols'] = result;\r\n}\r\n\r\nfunction json_to_array(key, jsonData){\r\n    return jsonData.map(v => key.map(j => { return v[j] }));\r\n}\r\n\r\nfunction fixdata(data) {\r\n    let o = ''\r\n    let l = 0\r\n    const w = 10240\r\n    for (; l < data.byteLength / w; ++l) o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)))\r\n    o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)))\r\n    return o\r\n}\r\n\r\nfunction get_header_row(sheet) {\r\n    const headers = []\r\n    const range = XLSX.utils.decode_range(sheet['!ref'])\r\n    let C\r\n    const R = range.s.r\r\n    for (C = range.s.c; C <= range.e.c; ++C) { \r\n        var cell = sheet[XLSX.utils.encode_cell({ c: C, r: R })] \r\n        var hdr = 'UNKNOWN ' + C \r\n        if (cell && cell.t) hdr = XLSX.utils.format_cell(cell)\r\n        headers.push(hdr)\r\n    }\r\n    return headers\r\n}\r\n\r\nexport const export_table_to_excel= (id, filename) => {\r\n    const table = document.getElementById(id);\r\n    const wb = XLSX.utils.table_to_book(table);\r\n    XLSX.writeFile(wb, filename);\r\n}\r\n\r\nexport const export_json_to_excel = ({data, key, title, filename, autoWidth}) => {\r\n    const wb = XLSX.utils.book_new();\r\n    data.unshift(title);\r\n    const ws = XLSX.utils.json_to_sheet(data, {header: key, skipHeader: true});\r\n    if(autoWidth){\r\n        const arr = json_to_array(key, data);\r\n        auto_width(ws, arr);\r\n    }\r\n    XLSX.utils.book_append_sheet(wb, ws, filename);\r\n    XLSX.writeFile(wb, filename + '.xlsx');\r\n}\r\n\r\nexport const export_array_to_excel = ({key, data, title, filename, autoWidth}) => {\r\n    const wb = XLSX.utils.book_new();\r\n    const arr = json_to_array(key, data);\r\n    arr.unshift(title);\r\n    const ws = XLSX.utils.aoa_to_sheet(arr);\r\n    if(autoWidth){\r\n        auto_width(ws, arr);\r\n    }\r\n    XLSX.utils.book_append_sheet(wb, ws, filename);\r\n    XLSX.writeFile(wb, filename + '.xlsx');\r\n}\r\n\r\nexport const read = (data, type) => {\r\n    const workbook = XLSX.read(data, { type: type });\r\n    const firstSheetName = workbook.SheetNames[0];\r\n    const worksheet = workbook.Sheets[firstSheetName];\r\n    const header = get_header_row(worksheet);\r\n    const results = XLSX.utils.sheet_to_json(worksheet);\r\n    return {header, results};\r\n}\r\n\r\nexport default {\r\n  export_table_to_excel,\r\n  export_array_to_excel,\r\n  export_json_to_excel,\r\n  read\r\n}\r\n"],"mappings":"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","ignoreList":[]}]}